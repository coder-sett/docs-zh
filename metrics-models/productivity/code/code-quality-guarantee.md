---
title: 代码质量保障
slug: /metrics-models/productivity/code-quality-guarantee
tags:
 - 评估模型
 - 生产力
 - 代码质量保障
description: 使用间接指标来评估代码质量保障做得如何
---

# 代码质量保障

代码，作为一个软件项目的最终输出件，是整个社区的核心内容。代码质量保障是使用多个代理指标来评估软件质量的保障制度。

# 评估模型中的指标

## 贡献者数量

* 定义：确定在过去 90 天内有多少活跃的代码提交者、代码审核者和 PR 提交者。
* 权重：19.987%
* 阈值：1000

## 代码提交频率

* 定义：过去 90 天内平均每周代码提交次数。
* 权重：16.363%
* 阈值：1000

## 是否维护

* 定义：在过去 90 天内至少提交了一次代码的周百分比 (单仓场景)。在过去 30 天内至少有一次代码提交记录的的代码仓百分比 (多仓场景)。
* 权重：13.853%
* 阈值：100%
* 注：单个仓库和多个仓库的定义是不同的。

## 代码提交关联 PR 的比率

* 定义：在过去 90 天内提交的代码链接 PR 的百分比。
* 权重：12.612%
* 阈值：100%

## PR 关联 Issue 的比率

* 定义：确定过去 90 天内新建 PR 关联 Issue 的百分比。
* 权重：11.319%
* 阈值：100%

## 代码审查比率

* 定义：确定在过去 90 天内提交代码中，至少包含一名审核者 (不是 PR 创建者) 的百分比。
* 权重：10.113%
* 阈值：100%

## 代码合并比率

* 定义：过去 90 天提交代码中，PR 合并者和 PR 作者不属于同一人的百分比。
* 权重：10.113%
* 阈值：100%

## 代码行数

* 定义：确定在过去 90 天内平均每周提交的代码行数 (增加行数加上删除行数)。
* 权重：5.640%
* 阈值：300000

# 评估模型算法

## 权重

我们使用 [AHP](https://en.wikipedia.org/wiki/Analytic_hierarchy_process) 来计算每个指标的权重。

### AHP 输入数据

| 指标名称 | 贡献者数量 | 代码提交频率 | 是否维护 | 代码提交关联 PR 的比率 | PR 关联 Issue 的比率 | 代码审查比率 | 代码合并比率 | 代码行数 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 贡献者数量 | 1.000 | 1.111 | 1.250 | 1.429 | 1.667 | 2.000 | 2.000 | 5.000 |
| 代码提交频率 | 0.900 | 1.000 | 1.250 | 1.250 | 1.429 | 1.667 | 1.667 | 2.500 |
| 是否维护 | 0.800 | 0.800 | 1.000 | 1.111 | 1.250 | 1.429 | 1.429 | 2.000 |
| 代码提交关联 PR 的比率 | 0.700 | 0.800 | 0.900 | 1.000 | 1.111 | 1.250 | 1.250 | 2.000 |
| PR 关联 Issue 的比率 | 0.600 | 0.700 | 0.800 | 0.900 | 1.000 | 1.111 | 1.111 | 2.000 |
| 代码审查比率 | 0.500 | 0.600 | 0.700 | 0.800 | 0.900 | 1.000 | 1.000 | 2.000 |
| 代码合并比率 | 0.500 | 0.600 | 0.700 | 0.800 | 0.900 | 1.000 | 1.000 | 2.000 |
| 代码行数 | 0.200 | 0.400 | 0.500 | 0.500 | 0.500 | 0.500 | 0.500 | 1.000 |

### AHP 分析结果

| 指标名称 | 特征向量 | 权重 |
| --- | --- | --- |
| 贡献者数量 | 1.599 | 19.987% |
| 代码提交频率 | 1.309 | 16.363% |
| 是否维护 | 1.108 | 13.853% |
| 代码提交关联 PR 的比率 | 1.009 | 12.612% |
| PR 关联 Issue 的比率 | 0.906 | 11.319% |
| 代码审查比率 | 0.809 | 10.113% |
| 代码合并比率 | 0.809 | 10.113% |
| 代码行数 | 0.451 | 5.640% |

### 一致性检验结果

| 最大特征根 | CI 值 | RI 值 | CR 值 | 一致性检验结果 |
| --- | --- | --- | --- | --- |
| 8.034 | 0.005 | 1.410 | 0.003 | 通过 |

## 阈值

我们选择的阈值是基于不同类型开源项目的大数据观测。

# 参考文献

* [CHAOSS 度量模型：社区服务和支持](https://github.com/chaoss/wg-metrics-models/tree/main/metrics-model-libs/community-service-and-support)

# 贡献者

## 前端

* Shengxiang Zhang
* Feng Zhong
* Chaoqun Huang
* Huatian Qin
* Xingyou Lai

## 后端

* Yehui Wang
* Chenqi Shan
* Shengbao Li
* Huatian Qin

## 评估模型

* Yehui Wang
* Liang Wang
* Chenqi Shan
* Matt Germonprez
* Sean Goggins
* Vinod Ahuja
